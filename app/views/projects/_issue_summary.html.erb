<section class="inner summary-panel">
  <h2>Issues so far</h2>

  <% if @issues.any? %>
    <div id="issue-chart"></div>

    <% for tag in @tags do %>
      <div class="issue-group">
        <h2 style="color: <%= tag.color %>"><%= tag.display_name %></h2>
        <ul class="issue-list drop-target" data-tag="<%= tag.name %>">
          <% for issue in @issues_by_tag[tag.name] %>
            <%= content_tag_for :li, issue, data: {url: issue_path(issue, format: :json)} do %>
              <%= link_to issue.title, issue %>
            <% end %>
          <% end %>
        </ul>
      </div>
    <% end %>

    <%# unassigned %>
    <div class="issue-group">
      <h2>Unassigned</h2>
      <ul class="issue-list drop-target">
          <% for issue in @issues_by_tag[:unassigned] %>
            <%= content_tag_for :li, issue, data: {url: issue_path(issue, format: :json)} do %>
              <%= link_to issue.title, issue %>
            <% end %>
          <% end %>
      </ul>
    </div>

  <% else %>
    <p class="no-content">There are no issues in this project yet.</p>
    <div>
      <%= link_to issues_path(), class: 'btn btn-large btn-primary' do %>
        <i class="fa fa-plus"></i> Add new issue
      <% end %> or <%= link_to upload_manager_path() do %><i class="fa fa-cloud-upload fa-lg"></i> Upload output from tool<% end %>
    </div>
  <% end %>
</section>

<% if @issues.any? %>
  <div id='issues-summary-data' data-tags='<%= @tags.map{ |t| [t.name, [t.display_name, t.color]] }.to_h.to_json %>' data-issues-count='<%= @count_by_tag.to_json %>'></div>
<% end %>
