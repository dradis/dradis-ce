<div class="comment-feed">
  <% if commentable.comments.any? %>
    <% commentable.comments.each do |comment| %>
      <%= div_for comment do %>
        <div class="body">
          <%= link_to(avatar_image(comment.user, size: 30), "##{dom_id(comment)}") %>

          <div>
            <% if comment.user %>
              <strong><%= comment.user.email %></strong>
            <% else %>
              a user who has since been deleted
            <% end %>

            <span class="time"><%= local_time_ago(comment.created_at) %></span>

            <% if comment.user == current_user %>
              <div class="actions">
                <%= link_to 'javascript:void();',
                            data: {toggle_comment: "on"} do %>
                  <i class="fa fa-pencil"></i> Edit
                <% end %>
                <%= link_to [commentable, comment],
                            method: :delete,
                            data: { confirm: 'Are you sure?' },
                            class: 'text-error' do %>
                  <i class="fa fa-trash"></i> Delete
                <% end %>
              </div>
            <% end %>
          </div>

          <div class="content">
            <%= comment.content %>
          </div>

          <% if comment.user == current_user %>
            <%= render 'comments/edit', commentable: commentable, comment: comment %>
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% else %>
    <p class="no-content">There has been no comments yet.</p>
  <% end %>

  <%= render 'comments/new', commentable: commentable %>
</div>
